<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arsip-Puskesmas Trenggalek</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded"
      rel="stylesheet"
    />
    <!-- di dalam <head>, sebelum script lainnya -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- TAMBAHKAN INI -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 2. DataTables CSS (Untuk styling) -->
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.6/css/dataTables.jqueryui.min.css"
    />
    <!-- 3. DataTables JS (WAJIB, harus setelah jQuery) -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

    <style>
      body {
        font-family: "Roboto", sans-serif;
      }
      .ripple {
        position: relative;
        overflow: hidden;
      }
      .ripple:after {
        content: "";
        position: absolute;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        transform: scale(0);
        opacity: 0;
        transition: all 0.6s;
      }
      .ripple:active:after {
        width: 200px;
        height: 200px;
        top: var(--y);
        left: var(--x);
        opacity: 1;
        transform: scale(1);
      }
      .opacity-0 {
        opacity: 0;
        transition: opacity 0.3s;
      }
    </style>
  </head>
  <body class="bg-gray-100 text-gray-800">
    <div class="flex h-screen">
      <!-- Sidebar -->
      <aside class="w-72 bg-white shadow-xl p-6 flex flex-col border-r">
        <h1 class="text-2xl font-bold mb-10 text-gray-800">Manajemen Surat</h1>
        <nav class="flex flex-col gap-2">
          <a
            data-page="dashboard"
            class="menu-item ripple flex items-center gap-4 py-3 px-4 rounded-xl hover:bg-gray-200 cursor-pointer"
          >
            <span class="material-symbols-rounded">dashboard</span>Dashboard
          </a>
          <!-- MENU YANG SUDAH DIPERBAIKI -->
          <a
            data-page="suratmasuk"
            class="menu-item ripple flex items-center gap-4 py-3 px-4 rounded-xl hover:bg-gray-200 cursor-pointer"
          >
            <span class="material-symbols-rounded">inbox</span>Surat Masuk
          </a>
          <a
            data-page="suratkeluar"
            class="menu-item ripple flex items-center gap-4 py-3 px-4 rounded-xl hover:bg-gray-200 cursor-pointer"
          >
            <span class="material-symbols-rounded">outbox</span>Surat Keluar
          </a>
          <!-- AKHIR MENU YANG DIPERBAIKI -->

          <a
            data-page="settings"
            class="menu-item ripple flex items-center gap-4 py-3 px-4 rounded-xl hover:bg-gray-200 cursor-pointer"
          >
            <span class="material-symbols-rounded">settings</span>Pengaturan
          </a>
        </nav>
      </aside>

      <!-- Content Area -->
      <main id="content" class="flex-1 p-8 overflow-auto"></main>
    </div>
    <!-- 1. Panggil file JavaScript modular kita -->
    <script src="js/dashboard.js"></script>
    <script src="js/suratmasuk.js"></script>
    <!-- TAMBAHKAN INI -->
    <script>
      const menuItems = document.querySelectorAll(".menu-item");
      const content = document.getElementById("content");

      document.addEventListener("click", (e) => {
        if (e.target.classList.contains("ripple")) {
          let rect = e.target.getBoundingClientRect();
          e.target.style.setProperty("--x", e.clientX - rect.left + "px");
          e.target.style.setProperty("--y", e.clientY - rect.top + "px");
        }
      });

      function setActiveMenu(el) {
        menuItems.forEach((i) =>
          i.classList.remove("bg-gray-800", "text-white")
        );
        el.classList.add("bg-gray-800", "text-white");
      }

      <!-- Letakkan ini di dalam tag <script> di index.html, mengganti logika dashboard sebelumnya -->

      function loadPage(page) {
        fetch(`pages/${page}.html`)
          .then((res) => res.text())
          .then((html) => {
            content.classList.add("opacity-0");
            setTimeout(() => {
              content.innerHTML = html;
              content.classList.remove("opacity-0");

              // Panggil fungsi inisialisasi yang sesuai setelah konten dimuat
              if (page === "dashboard") {
                initDashboard();
              }
              if (page === "suratmasuk") {
                initSuratMasukPage();
              }
            }, 200);
          })
          .catch((error) => {
            console.error("Error loading page:", error);
            content.innerHTML = `<div class="p-6 bg-red-100 text-red-700 rounded-lg">Error loading page: ${page}</div>`;
          });
      }

      menuItems.forEach((btn) => {
        btn.addEventListener("click", () => {
          const page = btn.getAttribute("data-page");
          loadPage(page);
          setActiveMenu(btn);
        });
      });
      // pemanggilan tiap fungsi dalam halaman
      document.addEventListener("DOMContentLoaded", function () {
        // Panggil fungsi yang sudah diekspor oleh dashboard.js
        initDashboard();
      });
      // akhir fungsi
      // Muat halaman pertama kali
      loadPage("dashboard");
      setActiveMenu(menuItems[0]);
    </script>
  </body>
</html>
